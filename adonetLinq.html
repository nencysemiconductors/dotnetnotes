<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./assets/css/master.css">
    <title>ADO.NET & LINQ</title>
</head>
<body>
    <nav>
        <ul>
            <li><a href="./index.html">C#</a></li>
            <li><a href="./advC.html">Advanced C#</a></li>
            <li><a href="./sql.html">SQL server</a></li>
            <li><a href="#">ADO.NET & LINQ</a></li>
        </ul>
    </nav>
    <h1>ADO.NET (ActiveX Data Objects)</h1>
    <ul>
        <li><span>framework</span> used to connect .NET apps to different Data Sources</li>
        <li>uses special namespaces called <span>Data Providers</span></li>
        <li>can connect to variety of data sources MS SQL Server, Oracle, XML, Excel files etc..</li>
        <li>architecture <br>
            <img src="./assets/adonetArch.png" alt="adonet architecture">
        </li>
    </ul>
    <h2>Data providers</h2>
    <ul>
        <li>connect to DB</li>
        <li>execute commands</li>
        <li>retrieve results</li>
    </ul>
    <table border="1px">
        <thead>
            <th>Provider name</th>
            <th>API prefix</th>
        </thead>
        <tr>
            <td>ODBC Data Provider(Open DB Connectivity - for older/legacy DB)</td>
            <td>Odbc</td>
        </tr>
        <tr>
            <td>Oledb data provider (Object Linking & Embedding database - for SQL server, access, excel)</td>
            <td>OleDb</td>
        </tr>
        <tr>
            <td>Oracle Data Provider</td>
            <td>Oracle</td>
        </tr>
        <tr>
            <td>SQL data provider (for MS SQL servers)</td>
            <td><span>Sql</span></td>
        </tr>
        <tr>
            <td>Entity Client Provider (for apps using EntityDataModel)</td>
            <td>Entity</td>
        </tr>
    </table>
    <h1>classes in SQL Data provider</h1>
    <ol>
        <li>SqlConnection</li>
        <li>SqlCommand</li>
        <li>SqlDataReader - obtain results in fast, forward-only, read-only stream</li>
        <li>DataSet - in memory representation of data</li>
        <li>SqlDataAdapter - transfer data to&from datasources in disconnected mode</li>
    </ol>
    <h2>SqlConnection</h2>
    <code>SqlConnection conn = new SqlConnection( &#60data source&#62, &#60initial catalog&#62, &#60integrated security&#62)</code> <br>
    <code>SqlConnection conn = new SqlConnection( "LocalDB", "PracticeDataBase", true)</code>
    <h2>SqlCommand</h2>
    <li>to execute queries in both connected & disconnected modes</li>
    <ul>
        <li>with out parameters <br>
            <code>SqlCommand cmd= new SqlCommand();</code>
        </li>
        <li>with query <br>
            <code>SqlCommand cmd= new SqlCommand( myQuery);</code>
        </li>
        <li>with query & connection <br>
            <code>SqlCommand cmd= new SqlCommand( myQuery, conn);</code>
        </li>
        <li>with query, connection & transaction br
            <code>SqlCommand cmd= new SqlCommand( myQuery, conn, transaction);</code>
        </li>
    </ul>
    <li>Commonly used methods of SqlCommand class</li>
    <ul>
        <li>ExecuteReader()</li>
        <li>ExecuteNonQuery()</li>
        <li>ExecuteScalar()</li>
        <li>ExecuteXmlReader()</li>
    </ul>
    <li>passing parameters to SqlCommand</li>
    <ul>
        <li>Add() - need to pass SqlParameter object <br>
            <code>
                SqlParameter p= new SqlParameter(); <br>
                p.ParameterName = "@empid"; <br>
                p.Value = input empid; <br>
                command.Parameters.Add(p);
            </code>
        </li>
        <li>AddWithValue() - variable & value passed directly <br>
            <code>
                command.Parameters.AddWithValue( "@empid", 101);
            </code>
        </li>
    </ul>
</body>
</html>